<!DOCTYPE html>
<html>

<head>
    <base target="_top">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        table {
            border-collapse: collapse;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }


        th,
        td {
            padding: 15px;
            text-align: center;
        }
    </style>
    <script>
        var _infoSheet = "<?!=_infoSheet?>"
        var auditIndex = "<?!=auditIndex?>"

        let loadTable = (tdata) => {
            document.getElementById("table").innerHTML = tdata
        }

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        // query string: ?foo=lorem&bar=&baz
        var a1code = getParameterByName('a1code'); // "lorem"
        var auditIndex = getParameterByName('auditIndex'); // "" (present with empty value)
        var _infoSheet = getParameterByName('_infoSheet'); // "" (present with no value)
        var rootText = getParameterByName('rootText'); // null (absent)
        var _auditPage = getParameterByName('_auditPage'); // null (absent)

        // google.script.run.withSuccessHandler(start).deserialize(_infoSheet);
        $(getData)
        var SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx_B19ltmD3Re4-CTIpCLR7-aRJRREvAhVxC8hMcn4gwQ6uoI-r/exec";


        function getData() {
            //tablereportV1  -vertical table
            //tablereport  - none
            document.getElementById("loadingoutput").innerHTML = "getting..."
            $.getJSON(SCRIPT_URL + "?callback=?", {
                    method: "tablereport",
                    _infoSheet: _infoSheet,
                    rootText: "roottext",
                    auditIndex: auditIndex
                },
                function(data) {
                    document.getElementById("loadingoutput").innerHTML = ""
                    loadTable(data)
                }
            );
        }
    </script>

</head>

<body>
    <div id="loadingoutput"></div>
    <div id="table"></div>

</body>

</html>